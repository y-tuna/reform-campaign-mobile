# reform_campaign_spec_v2.2

# 📑 개혁신당 캠페인 매니저 – 풀패키지 기획/명세 문서 (목차 v2.2)

누적 기획 (context) + 0902 회의 + 지도부 인사이트 + 러버블 데모 + GPT 캔버스 UI/기획 기반 GPT 정리

# 목차 v2.2

1. **서비스 기획 (Product Vision & Scope)**
    - 배경, 목표, 유저 타입, 페르소나, 주요 시나리오
2. **개발 기능 명세 (Feature & Tech Spec)**
    - 플랫폼별 기능
    - 데이터 플로우
    - API 스펙
    - 데이터 모델
3. **정책 기획 (Operational Policies)**
    - 권한 체계
    - 운영 정책
    - 데이터/보안 정책
4. **로드맵 (Roadmap & Milestones)**
    - 일정
    - 리스크
    - 운영 지표
5. **사용자 시나리오 (Representative Scenarios)**
    - 예비후보자 루프
    - 후보자 루프
    - 챗봇 → 웹 리다이렉트
    - 크레딧 루프
    - 중앙 관리자 시나리오
6. **스케줄러 운영 규칙 (Scheduler Rules & Scoring)**
    - 입력 데이터
    - 우선순위 산식
    - 모드 전환(예비/후보자)
    - 중앙 가중치
7. **데이터 계약 (Front–Back Contracts)**
    - Task.tertiary / type
    - Proof.kind
    - Broadcast.severity
    - Profile.intensity / mobility / religion_pref
8. **화이트리스트 & 증빙 정책**
    - 중앙선관위 지정 품목 화이트리스트
    - 증빙(사진/영수증) 요건
    - 심사 기준 (자동 vs 관리자 승인)
9. **챗봇 구조 (Election-law Q&A)**
    - 룰베이스 Q&A → 모달 → 웹 리다이렉트
    - FAQ/사례 기반
    - 선관위 문서/가이드 연계
10. **추가 과제 & 확장(Ahead Tasks)**
- 무한 스크롤, A/B 테스트, POI 데이터 통합, 공보물 발주 자동화
- 다당제 확장(타 정당 계약 시 구조 확장)
- 교육 모듈 (출마자 교육/톤앤매너)

---

# 기획 세부

## 1. 서비스 기획 (Product Vision & Scope)

### 1.1 배경

- **정치 캠페인 특수성**
    - 선거철 실무자는 PC 앞에 앉아 있을 시간이 거의 없음.
    - 주요 활동은 전화, 인사, 현수막 설치 등 → **현장 즉시성**이 핵심.
- **개혁신당의 수요**
    - 이미 “모바일 앱 + 웹 CRM” 요구 명확히 제시.
    - 이준석 의원실 9/2 미팅에서 **유세 스케줄러**, **공천/공보물 자동화**, **후원·정산**이 핵심 우선순위로 확인됨.
- **현실적 제약**
    - 후보자 대부분이 풀타임 캠프 운영이 어려움 → **앱 기반 가이드** 없으면 현장에서 갈피 잃음.
    - 데이터 관리·분석은 중앙당/관리자 웹에서 처리.

### 1.2 목표

- **모바일 앱 (가칭: 비서AI)**
    - 기반: React Native + FastAPI (Python BE), 공통 DB(PostgreSQL).
    - 기능: 오늘의 유세 추천 루트, 활동 기록, 챗봇, 랭킹, 크레딧 표시.
    - 포인트: **현장성/단순성**, Default ↔ Senior UI 자동 적용.
- **웹 (가칭: 개혁신당 캠페인)**
    - 기반: Next.js (FE) + Spring/Python (BE) + PostgreSQL.
    - 기능: 후보 활동 집계, 대시보드, 공지 푸시, 서류/공보물 검토, 후원 관리.
    - 포인트: **분석·행정 허브**.
- **차별성**
    - 일반 CRM은 단순 연락처/후원 관리에 치중.
    - 본 서비스는 **“유세 스케줄링 + 자동화된 행정 툴”** 결합으로 후보자의 진입장벽을 낮춤.

### 1.3 유저 타입

- **타입 1: 출마자 (예비후보자·후보자)**
    - 원칙적으로 **캠프당 1계정**.
    - 필요 시 사무관 등과 공유 가능하지만 책임은 본인.
    - 기능: 앱 액션 실행, 증빙 업로드, 웹 서류 제출.
- **타입 2: 중앙당 관리자**
    - 역할: 전체 후보 활동 모니터링, 공지/전술 푸시, 정산 집행.
    - 권한: 후보 데이터 열람, 증빙 승인, 정책 개입.

### 1.4 사용자 페르소나

- **2030 (예비)후보자**
    - 모바일 친숙, 빠른 루프 필요.
    - 니즈: 자동 스케줄링, 간단 증빙, 챗봇 기반 가이드.
- **4050 (예비)후보자**
    - 데이터·자료 관리 중요.
    - 니즈: 증빙 확실, 대시보드 통한 활동 피드백.
- **60+ (예비)후보자**
    - 단순 UI 필요.
    - 니즈: 큰 글씨/한 화면에 하나의 액션(Senior 모드).
- **중앙당 관리자**
    - 다수 후보 관리, 리스크 차단.
    - 니즈: 집계 대시보드, 공지 푸시, 규정 준수 모니터링.

### 1.5 주요 시나리오

- **앱 – 예비후보자 루프**
    - 접속 → 상단 공지 리본 확인 → 자동 생성된 오늘의 루트 요약 확인 → 할 일 카드 실행:
        - POI 인사 유세 → 시작(트래킹 ON) → 완료(사진/메모) → 증빙 업로드.
        - 시설/단체 방문 → [열기] → 일정공지/안건 모달 → 필요 시 웹 리다이렉트.
        - 공천/출마 서류 준비 → 체크리스트 모달 → [제출하러 가기] → 웹 서류 제출.
        - 유세 물품 구매 → 제휴몰 웹 리다이렉트 → 결제 후 증빙 업로드.
- **앱 – 후보자 루프 (법정 등록 이후)**
    - 거점 인사(출·퇴근/상권) 중심 자동 루트 상향.
    - ETA 배지, 네비게이션 강조.
    - 중앙 푸시 공지(특정 출구 집중 등) 상단 리본 노출.
- **앱 – 챗봇**
    - “선거법 OO 가능?” → 룰베이스 Q&A → 근거 스니펫 → [자세히 보기] → 웹 정책 문서 뷰어.
    - 체크리스트/가이드 링크도 웹 이동.
- **앱 – 크레딧 루프**
    - 온보딩 시 공천금/예산을 크레딧으로 표기(결제X).
    - 제휴 구매·증빙 업로드 시 크레딧 차감.
    - 후원금 유입 시 크레딧 가산.
    - 월말 대시보드 → 수입/지출/증빙 대기 집계.
- **웹 – 중앙 관리자 시나리오**
    - 후보자 리스트/상세 뷰.
    - 공지·전술 푸시 발송.
    - 서류/증빙 검토 및 승인.
    - 활동 랭킹 확정 → 상위 일부 크레딧 환급 실행.

## 2. 개발 기능 명세 (Feature & Tech Spec)

### 2.1 전체 시스템 개요

- **앱 (React Native · Expo)**
    - 역할: 출마자 전용 → 오늘의 유세 루트 실행, 챗봇, 활동 기록, 대시보드
    - 특징: Default/Senior UI 분기, 하루 자동 스케줄러, 증빙 업로드
- **웹 (Next.js FE + Java Spring/FastAPI BE)**
    - 역할: 중앙당 관리자용 → 활동 모니터링, 공천/공보물/후원 관리
    - 특징: 리스트·테이블 기반, 집계/랭킹, 문서 처리
- **백엔드 (FastAPI, Python)**
    - 역할: API 게이트웨이 + 스케줄러 + 챗봇
    - 특징: RESTful API + JWT 인증, PostgreSQL 연동
- **DB (PostgreSQL + PostGIS)**
    - 역할: 모든 데이터의 단일 소스 (유저/과업/POI/증빙/후원/문서)
    - 특징: GIS 기능 포함, 선거법 준수한 데이터 보존정책 적용
- **인프라**
    - 배포: Railway/Render (BE), Vercel (Web), Expo EAS (App)
    - 데이터 보관: AWS S3 호환 스토리지 (증빙/이미지)

### 2.2 플랫폼별 상세 기능

| 구분 | 모바일 앱 (비서AI) | 웹 (개혁신당 캠페인) |
| --- | --- | --- |
| 핵심 | 오늘의 유세(지도+카드), 자동 스케줄러, 활동 기록, 챗봇 | 후보자 관리, 공지 푸시, 대시보드, 서류 검토, 공보물 자동화, 후원 관리 |
| 접근성 | Default/Senior UI 자동 추천 (나이, 폰트 스케일 기반) | 리스트·테이블 중심, 필터링·CSV 다운로드 |
| 스케줄러 | POI/클러스터 기반 자동 루트 생성, ETA, 우선순위 점수 | 중앙 정책 가중치 수정, 이벤트 강제 삽입 |
| 증빙 | 사진/영수증 업로드, GPS/시간 자동 태깅 | 증빙 승인/반려, 사유 기록 및 감사로그 |
| 크레딧 | 공천금·후원금 연동 표기, 활동 환급 | 월말 정산/환급 집행, CSV 출력 |
| 챗봇 | 선거법/체크리스트 질의응답, 웹 연계 | 문서/사례 등록, FAQ 관리 |
| 권한 | 출마자 단일 계정 (필요시 사무관 공유) | 중앙 관리자(풀뷰), Viewer(옵션) |

### 2.3 데이터 플로우

```mermaid
flowchart TB
  subgraph MobileApp[Mobile App (React Native)]
    A1[Onboarding] --> A2[Schedule Today]
    A2 --> A3[Task Start/Complete]
    A3 --> A4[Proof Upload]
    A2 --> A5[Chatbot Ask]
  end

  subgraph API[FastAPI Backend]
    B1[Auth/JWT]
    B2[Scheduler Engine]
    B3[Chatbot Engine]
    B4[Credit Ledger]
    B5[File Upload]
  end

  subgraph DB[(PostgreSQL + PostGIS)]
    C1[Users/Profiles]
    C2[Tasks/Routes]
    C3[Proofs]
    C4[POIs/Clusters]
    C5[Credits/Donations]
    C6[Docs/Broadcasts]
  end

  subgraph Web[Web (Next.js + Java/Python)]
    D1[Dashboard]
    D2[Docs Review]
    D3[Ad Generator]
    D4[Broadcasts]
    D5[Donations]
  end

  A1 --> B1
  A2 --> B2
  A5 --> B3
  A4 --> B5
  B1 --> C1
  B2 --> C2
  B5 --> C3
  B3 --> C6
  B4 --> C5
  D1 --> C2
  D2 --> C6
  D3 --> C6
  D4 --> C6
  D5 --> C5

```

### 2.4 스케줄러 로직

- **입력 데이터**
    - 인구·유동 시그널 (교통, 시간대별 혼잡도)
    - POI 메타데이터 (타입, 접근성, 체류 가능성)
    - 이벤트 (졸업식, 장터, 단체 회의)
    - 후보자 선호도 (종교/이동수단/강도)
    - 과거 성과 (접촉 수, 반응률)
    - GIS 거리 및 이동시간
- **우선순위 점수 산식 (예시)**
    
    ```markdown
    score = (α*시간대 + β*타깃군매칭 + γ*접근성 + δ*지역다변화 + ε*과거성과 + ζ*중앙가중치)
    
    ```
    
- **운영 규칙**
    - 예비후보자 모드 → 시설/단체 비중 ↑
    - 후보자 모드 → 거점 인사(출퇴근, 상권) ↑
    - 1일 과업 수 N, 체류·이동 제한 포함

### 2.5 챗봇 구조

- **엔진**: 룰베이스 + Q&A DB (선거법/서류/공보물 사례)
- **앱 UX**:
    - 질문 입력 → 답변 + 근거 스니펫
    - [자세히 보기] → 웹 리다이렉트
- **확장**:
    - 중앙 관리자가 FAQ/사례 추가 가능
    - 답변 로깅 → 추후 모델 학습 데이터

### 2.6 크레딧 구조

- **개념**: 결제 아님, 표기용 회계
- **흐름**
    - 공천금/후원금 유입 → 크레딧 가산
    - 제휴 구매/지출 → 크레딧 차감
    - 증빙 미승인 → pending 처리
    - 월말 정산 → 대시보드/CSV 반영
- **환급 정책**
    - 랭킹 기반 보상 (예: 상위 10% 환급)
    - 중앙당 Rule Engine 관리

### 2.7 보안 및 정책

- **인증/인가**
    - 휴대폰 본인 인증
    - JWT + RBAC (candidate, admin, viewer)
- **데이터**
    - PII 최소 수집, AES-256 암호화
    - 전송 시 TLS 적용
    - 선거 종료 +30일 자동 파기
- **증빙**
    - GPS/시간 메타 포함
    - 파일 해시 저장, 변조 방지
- **운영**
    - 장애 시 fallback 모드 → 단순 체크리스트

## 3. 인프라/배포/품질 (Infra / Deployment / Quality)

### 3.1 백엔드/데이터 (권장 우선순위)

- **Supabase(권장 기본)**: PostgreSQL + Auth + Storage + Realtime
    - RN/Next 공용 SDK: `@supabase/supabase-js`
    - *RLS(행 수준 보안)**로 선언적 접근제어 → 후보/관리자 권한 모델 구현 용이
    - 파일(증빙/사진) 업로드: Storage + 서명 URL(만료)
- **(선택) FastAPI**: 서버 전용 로직/비밀키/웹훅/배치
    - 예: 스케줄러 점수산식(POI/클러스터), 결제/정산용 안전 처리, 외부 제휴 API 키 관리
    - 도입 타이밍: **Supabase만으로 커버 어려운 순간부터 추가**

> 전략: MVP는 Supabase 단독으로 빠르게 → 서버 전용 비밀 로직이 필요해지는 시점에 FastAPI를 병행
> 

### 3.2 앱 빌드·배포 (Expo 중심)

- **Expo + EAS(Build/Update)**
    - Dev: `expo start` → QR 스캔해서 **실기기** 즉시 실행
    - **EAS Build**: iOS/Android 테스트 빌드 자동화
    - **EAS Update(OTA)**: 스토어 심사 없이 JS/에셋 핫픽스 배포(네이티브 변경 시에는 스토어 빌드 필요)
- **푸시 알림**
    - 초기: **Expo Notifications**
    - 확장: OneSignal / Firebase(FCM)로 마이그레이션 가능

### 3.3 웹 (Next.js)

- 배포: **Vercel** (PR마다 Preview 링크 자동)
- 환경변수: `NEXT_PUBLIC_*` 접두사(클라 노출 OK), 민감 값은 Vercel Secret으로

### 3.4 공통 계약/공유 레이어 (강추)

- **OpenAPI 스키마**로 API 계약 정의 → **TS SDK 생성** 후 **웹/RN 공용** 사용 (`/packages/api-client`)
- **디자인 토큰**(`/packages/design-tokens`): 색/간격/폰트 토큰을 웹·RN 모두에서 사용
- **공통 타입/유틸**(`/packages/shared`): Zod 스키마, 날짜/좌표, 포맷터 등

### 3.5 관측/품질/실험

- **에러 모니터링**: Sentry(웹/앱/서버 공통)
- **로그/분석**: Amplitude/Mixpanel 또는 Supabase Analytics
- **Feature Flag**: GrowthBook/Unleash (클라·서버 SDK 지원)

## 4. 정책 기획 (Operational Policies)

### 4.1 권한 체계 (RBAC)

| 구분 | 권한 | 액션 |
| --- | --- | --- |
| 출마자 (예비/후보자) | candidate | 모바일 앱 전 기능 사용 (스케줄, 챗봇, 증빙 업로드, 대시보드 확인). 웹 접근은 개인 자료 업로드·확인 한정. |
| 캠프 스태프 (비공식) | candidate 계정 공유 | 공식 권한 없음. 출마자 계정 공유로 입력/업로드를 대신 처리. 보안 리스크 → 경고 안내. |
| 중앙 관리자 (지도부) | admin | 모든 후보자 활동/서류/증빙 뷰. 공지·전술 푸시, 정책 Rule 변경, 환급 집행. |
| 읽기 전용 뷰어 (선택) | viewer | 특정 데이터 열람만 가능. 예: 회계 감사 목적. |

### 4.2 운영 정책

- **앱 운영**
    - 기본: 자동 스케줄러 기반으로 할 일 제공.
    - Senior 모드: 고연령층을 위한 큰 글씨/단일 카드 뷰.
    - 증빙 업로드 필수: 사진/영수증 + GPS/시간 메타.
    - 챗봇은 룰베이스 Q&A → 법적 책임은 후보자에게 있음.
- **웹 운영**
    - 중앙 관리자용: 대시보드, 서류 검토, 공보물 자동화, 후원 정산.
    - 후보자용: 웹 리다이렉트된 상세 기능(서류 제출, 광고주문 등) 처리.
- **공지·전술 푸시**
    - 중앙당에서 특정 지역/후보자 그룹 대상으로 브로드캐스트 가능.
    - 예: “[중앙 공지] 오늘 17:30 OO역 3번출구 집중 인사 권고”.
    - 푸시는 기록·철회 가능, 모든 내역 감사 로그 저장.

### 4.3 데이터 정책

- **보관 주기**
    - 선거 종료 후 +30일: 모든 GPS/증빙/PII 자동 삭제.
    - 회계/정산 관련 최소 보존 의무는 CSV 내보내기 후 별도 관리.
- **보안**
    - PII 최소 수집 원칙.
    - AES-256 암호화 저장.
    - HTTPS 전송.
    - 파일 다운로드/열람 시 로깅(누가/언제/무엇 확인했는지).
- **데이터 활용**
    - 과거 성과(접촉 수, 증빙 기록)는 익명화 후 향후 스케줄러 학습에 사용.
    - 특정 지역 POI 족보(출퇴근/시장/회의 장소)는 공용 DB화.

### 4.4 회계·정산 정책

- **크레딧 구조**
    - 공천금, 후원금, 선거 지출 → 크레딧 형태로 표기.
    - 결제는 아님. 실제 결제는 제휴몰/은행 경로.
    - Pending: 증빙 대기.
    - Approved: 정산 반영.
- **환급**
    - 월말 랭킹 기준 상위 N명에게 일부 크레딧 환급.
    - Rule Engine에서 정책 버전/시행일 기록 관리.
- **증빙 심사 기준**
    - **화이트리스트 제품군**: 선관위 지정 물품 (현수막, 명함, 어깨띠, 홍보차량 등)만 승인.
    - 증빙 자료: 원본 사진/영수증 + GPS/시간 메타.
    - 위배 시: 반려 처리 + 경고 푸시.

### 4.5 선거법/컴플라이언스

- **중앙선관위 지침 준수**
    - 지정 품목 외 물품 구매 → 자동 차단.
    - 선거 종료 후 데이터 폐기 필수.
    - 공보물: 가이드라인 내 문구 필터링(민감 발언, 비방 금지).
    - 챗봇은 과거 Q&A/선관위 사례를 기반으로 제공 → 법적 책임 회피용 디스클레이머 표시.
- **예비후보자 vs 후보자**
    - 예비후보자: 시설 방문/유대감 형성 위주.
    - 후보자 등록 이후: 거점 인사, 출퇴근 상권 집중.
    - 스케줄러와 카드 비율이 자동 전환됨.

### 4.6 교육·훈련 정책

- **출마자 오리엔테이션**
    - 앱 설치 및 온보딩 (폰트/종교/이동수단/강도 설정).
    - 증빙 업로드 방법.
    - 챗봇 질의 활용법.
- **캠프 스태프 교육**
    - 기본 매뉴얼 PDF/영상 제공.
    - “민폐 없는 선거운동” 가이드 (이기인 총장 제안 반영):
        - 명함 줄 때 태도/톤
        - 시간대별 선거운동 적합/부적합 상황
        - 지역 주민 불편 최소화 규칙

### 4.7 품질·운영 정책

- **Fallback 모드**
    - 스케줄러 서버 장애 시 → 단순 체크리스트 모드 전환.
- **관측 지표**
    - GPS 업로드율
    - 증빙 승인율
    - 챗봇 질문 응답률
    - 푸시 수신/읽음률
- **중앙 개입**
    - 관리자 푸시 개입 시 기록 필수.
    - 당대표/지도부 격려 메시지는 자동화하지 않고, 사람이 직접 발송.

## 5. 로드맵 (고객 공유용 + 내부 실행)

### 5.1 단계별 계획

| 단계 | 기간 | 주요 산출물 | 상세 내용 |
| --- | --- | --- | --- |
| 기능 정의 (Spec Lock) | 9월 1주 | v1.0 기획/명세 문서 | 0902 미팅·의견 반영 → 서비스 비전·기능 확정 |
| 1차 개발 (MVP Core) | 9월 2~3주 | 앱 기본 화면(React Native), 웹 업로드 기능 | Adaptive Scheduler Mock UI, 기본 Proof Upload, Credit 표기 |
| 내부 테스트 | 9월 4주 | QA 보고서 | 시뮬레이션 계정 테스트, UI/UX 접근성 검증(Default/Senior) |
| 납품 1차 | 10월 1주 | 앱 + 웹 1차 버전 | 후보자 온보딩, 오늘의 유세, 챗봇 기본 Q&A, 웹 문서 업로드 |
| 확장 개발 (v1.5) | 10~11월 | 공보물 자동화, 공천 서류 제출, 관리자 푸시 | Adsland API 연동, 서류 이관 자동화, Broadcast 모듈 |
| 공천 마감 대응 | 11월 | 안정화 패치 | 후보자 등록 전환 로직(예비→후보자), 크레딧/회계 모듈 고도화 |
| 선거 직전 빌드업 | 12월~2월 | 대시보드 강화, 랭킹, 크레딧 환급 | 활동 랭킹 집계, Top-N 환급 자동 집행, 후보자 사기 진작 기능 |
| 선거 기간 운영 | 3월~6월 (선거일까지) | 실시간 운영 지원 | 서버 모니터링, 장애 대응, 관리자 푸시, 선거법 업데이트 챗봇 |
| 종료 +30일 | 7월 | 데이터 정리/파기 보고서 | 모든 후보자 GPS/증빙 삭제, CSV Export 제공, 클로징 보고서 |

### 5.2 고객 공유용 하이라이트

- 📱 **앱 (비서AI)**: 오늘의 유세 자동 스케줄러 + 증빙 업로드 + 챗봇 Q&A
- 💻 **웹 (캠페인)**: 대시보드 집계 + 서류 검토/제출 + 공보물 발주 + 후원 관리
- 🎯 **중앙 관리자 기능**: 공지/전술 푸시 + 활동 랭킹 확인 + 환급 집행
- 🔒 **정책 준수**: 선거 종료 후 30일 데이터 자동 삭제, 선관위 품목 화이트리스트

### 5.3 내부 실행 체크리스트

- [ ]  **데이터 계약 정합성 확인**: Task/Proof/Broadcast/Profiles 키값 일관성
- [ ]  **스케줄러 알고리즘**: 예비→후보 모드 전환 로직 자동 반영
- [ ]  **챗봇 지식베이스**: 선관위 Q&A 사례 PDF 크롤링 → 룰베이스 구축
- [ ]  **크레딧 회계**: “표기용 Ledger” 구현, 실제 결제 경로와 분리
- [ ]  **공보물 API 연동**: Adsland 등 파트너사 테스트
- [ ]  **무한 스크롤 UI**: IntersectionObserver 시뮬레이션 구현
- [ ]  **Fallback 모드**: 스케줄러 장애 시 체크리스트 모드 전환
- [ ]  **접근성 테스트**: Senior 모드 글자 크기/단일 카드 뷰 검증

### 5.4 리스크 관리

- **시간 압박**: 선거 일정 고정 → 기능 우선순위 명확히
- **문서화 부족 리스크**: 지금 단계에서 최소 기획/명세 확정 필수
- **데이터 보안**: PII, GPS → 유출 시 법적 리스크 → 암호화/파기 철저
- **정책 충돌**: 선관위 규정 변동 시 챗봇·화이트리스트 즉시 업데이트 필요
- **운영 리스크**: 서버 부하 대비 → Railway/Render + CDN 캐싱 활용

### 5.5 향후 고도화 (Post-MVP)

- 🏷️ **Gamification**: 후보자 랭킹/배지/퀘스트 시스템 확장
- 📊 **비교 랭킹**: 동일 선거구 타 정당 후보 GPS/활동 대비 랭킹 (이기인 총장 제안)
- 🧑‍💻 **AI 보조**: 증빙 자동 분류(사진/영수증 OCR), POI 제안 고도화
- 🗂️ **출마자 교육 패키지**: 온라인 튜토리얼 + 오프라인 교육 모듈
- 💬 **확장 챗봇**: 선거법 외 → 지역 공약 설계, 공보물 카피 추천

## 6. 추가 보강 (시나리오 · 스케줄러 · 데이터 계약 등)

### 6.1 대표 사용자 시나리오 (앱 중심, 웹 연계)

### A. (예비)후보자 – “오늘의 유세” 실행 루프

1. 앱 접속 → 상단 리본(중앙 공지/가이드) 확인
2. 상단 미니맵에서 자동 생성된 동선 요약 확인
    - 예상 접촉 수, 이동 거리, 우선순위 점수 표시
3. 하단 할 일 카드 (우선 2개 노출 → 스크롤 시 추가):
    - **유형 A: POI 인사 유세** → [시작] → GPS 트래킹 ON → [완료] 시 사진·메모 → 증빙 업로드
    - **유형 B: 시설/단체 방문** → [열기] → 일정/안건 모달 → 필요 시 웹 리다이렉트
    - **유형 C: 공천·출마 서류 준비** → 체크리스트 모달 → [제출하기] → 웹 리다이렉트
    - **유형 D: 유세 물품 구매** → 제휴몰 웹 리다이렉트 → 결제 후 영수증 업로드
4. 활동 종료 → 대시보드 탭에서 금일 기록 확인
    - (접촉 수, 이동 거리, 완료 과업, 사용 크레딧)
5. (월말) 활동 랭킹 반영 → 상위 일부 후보 크레딧 환급

### B. 후보자 모드 전환 (법정 후보자 등록 이후)

- 스케줄러: 거점 인사(출퇴근·상권) 비중 ↑, 시설/단체 방문 ↓
- 네비게이션/ETA 가이드 강화
- 중앙당 전술 공지(예: 특정 출구 집중) → 리본으로 푸시

### C. 챗봇 플로우 (앱 → 웹)

- “선거법 ○○ 가능?” → 룰베이스 Q&A → 유사사례 근거 모달
- [자세히 보기] → 웹 정책/사례 뷰어 리다이렉트
- 챗봇 내 체크리스트/서류 링크 → 웹 리다이렉트

### D. 크레딧(표기) 루프

- 온보딩 시 공천금·선거예산을 크레딧으로 표기 (결제 기능 아님, 회계 표기용)
- 앱/웹 제휴 구매·증빙 업로드 시 차감
- 후원금 유입 시 크레딧 가산
- 월말 대시보드 → 수입·지출·증빙대기 집계

### E. 중앙당 관리자 시나리오 (웹)

- 후보자 리스트/개별 상세: 활동, 증빙, 서류, 후원, 경고
- 공지·전술 푸시 작성 (선거구/타깃별 브로드캐스트)
- 월간 랭킹 확정 → 상위 N명 크레딧 환급 집행

### 6.2 스케줄러 입력 & 우선순위 규칙

### 입력 데이터

- 인구·유동 시그널 (시간대별)
- POI 메타 (접근성, 체류 용이성)
- 이벤트 (졸업식, 장터, 집회 등)
- 후보자 선호 (종교/이동수단/강도 설정)
- 과거 성과 (접촉 수, 체류 성과)
- GIS 기반 거리·이동시간

### 우선순위 산식

```
Score = (β1 * TimeMatch)
      + (β2 * TargetCluster)
      + (β3 * Accessibility)
      + (β4 * Diversity)
      + (β5 * PastPerformance)
      + (β6 * CentralDirective)

```

- TimeMatch: 시간대/출퇴근 피크 적합성
- TargetCluster: 2030/중도 무당층 가중
- Accessibility: 분기점, 횡단보도, 체류 안전
- Diversity: 커버리지, 중복 최소화
- PastPerformance: 최근 7~14일 성과 회귀
- CentralDirective: 특정 POI 집중 시 가중치

### 모드별 가중치

- **예비후보자 모드:** 시설·단체, 라포 형성 ↑
- **후보자 모드:** 거점 인사, 유동 밀집 유세 ↑

### 제약 조건

- 1일 N개(예: 3~6개)
- 체류 시간 15~30분, 총합 ≤ 일정 강도 값
- 이동 거리 ≤ 후보자 이동수단별 허용치
- 법규 위반 가능성 있는 POI 자동 제외

### 6.3 데이터 계약 (FE–BE 공통 키)

| 계약 키 | 값 집합 | 설명 |
| --- | --- | --- |
| `Task.tertiary` | defer · proof · nav · open | UI 버튼 라벨 & 동작 매핑 |
| `Task.type` | poi-visit · facility-visit · doc-check · ad-purchase | 액션 카드 유형 |
| `Proof.kind` | photo · receipt | 증빙 종류 |
| `Broadcast.severity` | info · warn · critical | 공지 리본 톤 |
| `Profile.intensity` | hard · normal · light | 스케줄 강도 |
| `Profile.religion` | allowAll · exclude · onlyX | 종교 기관 방문 선호 |
| `Mobility` | car · pickup · trike · bike · walk | 루트 속도/거리 보정 |

### 6.4 화이트리스트 제품군 (중앙선관위 승인 가능 범위)

- 홍보물: 현수막, 어깨띠, 명함, 배너, 유세복 (규격 제한 준수)
- 장비: 마이크, 휴대용 스피커, LED 보드 (규격 내), 유세차량(구의원은 불가)
- 소모품: 배터리, 보온장치, 기본 홍보물 패키지
- 중앙 플랫폼에서 지정된 벤더 API 연계로만 구매 가능 → 불법 품목 자동 필터링

### 6.5 증빙 심사 기준

- **필수 메타**: GPS 좌표 + 촬영시간 (자동 태깅)
- **파일 요건**: 원본 파일 해시 검증, 편집본 불허
- **영수증**: 공급자 상호·사업자번호·품목 일치 여부 확인
- **현장 사진**: 위치 매칭 + 체류 시간 로그 검증
- **승인 플로우**: 후보자 업로드 → 중앙 관리자 검토 → 승인/반려 (사유 기록)

### 6.6 챗봇 구조

- **Layer 1: 룰베이스 Q&A**
    - 선거법, 공천 서류, 공보물 규정 등 키워드 기반 매칭
    - 중앙선관위 질의응답 DB / 내부 가이드라인 학습
- **Layer 2: 정책 문서 뷰어 연계**
    - “자세히 보기” → 웹 뷰어로 리다이렉트
- **Layer 3: 컨텍스트 추천**
    - 서류 준비 → 체크리스트 모달 호출
    - 공보물 문의 → 자동 템플릿 API 연결
- **운영 정책**: AI 임의 생성 금지, 모든 답변은 근거·출처 포함

## 7. 스케줄러 입력/우선순위 (운영 규칙)

### 7.1 입력 데이터 소스

자동 스케줄링을 위해 필요한 데이터와 수집 방식:

- **인구/유동 데이터**
    - 행정안전부 주민등록 인구 통계 (정주 인구)
    - SKT/KT/LGU+ 유동인구 API (시간대별 이동 패턴)
    - 국토부 교통카드·버스/지하철 승하차 API
    - 지역 행사 캘린더(졸업식·축제 등)
- **POI 메타데이터**
    - 카테고리: 지하철, 버스환승, 학원가, 시장, 종교시설, 복지관 등
    - 접근성: 출구 수, 횡단보도 개수, 체류 공간 유무
- **후보자 선호도**
    - 종교 기관 방문 여부 (온보딩 설정)
    - 이동 수단 (자차/픽업/도보/자전거 등)
    - 일정 강도(빡셈/보통/느슨)
- **GIS & 교통**
    - OSRM/GraphHopper 기반 ETA(예상 소요시간)
    - 교통 혼잡도, 도보 우선 루트
- **과거 성과**
    - 동일 지점에서의 접촉 수 기록
    - 증빙된 활동량(사진/메모/명함 반응률 등)

### 7.2 우선순위 산식 (예시)

공식(단순화 예시):

```
Score(poi) = (BaseExposure × TimeWeight × TargetMatch)
             + PastPerformance × α
             + Accessibility × β
             + DiversityBonus × γ
             + CentralDirective × δ

```

- **BaseExposure**: 지점별 기본 노출값 (예: 지하철 300, 버스환승 200)
- **TimeWeight**: 출퇴근/점심/주말 가중치 (출퇴근 ×1.4, 점심 ×1.0, 주말 ×1.2 등)
- **TargetMatch**: 20·30대, 중도 무당층 비율 매칭 점수
- **PastPerformance**: 최근 7~14일간 동일 POI 실적 (회귀 반영)
- **Accessibility**: 체류 용이성, 분기 수, 횡단보도 접근
- **DiversityBonus**: 중복 최소화(새로운 지점일수록 보너스)
- **CentralDirective**: 중앙당 지정 전술 가중치 (예: 특정 출구 집중)

### 7.3 모드 전환 규칙

- **예비후보자 모드 (2월 예비후보 등록 이전)**
    - 시설·단체 방문 비중 ↑ (경로당, 주민센터, 회의 참여)
    - 라포 형성 및 진정성 어필
- **후보자 모드 (후보 등록 이후)**
    - 거점 인사 위주 (출근/퇴근/상권 중심)
    - 유동인구 밀도 기반 최적 루트
    - ETA 배지, 체류시간 가이드 강화

### 7.4 운영 룰

- 하루 최대 N개 일정 (예: 3~6개)
- 체류시간 총합 150~180분
- 이동시간 총합 ≤ X분 (사용자 선호도 반영)
- 안전/법규 우선:
    - 통행 방해 구간 제외
    - 선관위 허용 범위 벗어난 활동 제외
- 실시간 알림:
    - 30분 전 ETA 리마인드
    - “과밀/중복” 발생 시 자동 대체 추천

### 7.5 UI/UX 반영

- 지도뷰 핀에 ETA 뱃지 노출
- 동선 요약 시 예상 접촉 수, 거리, 점수 총합 표시
- 카드뷰 클릭 시 “선정 근거” 모달:
    - 시간대 신호
    - 타깃군 매칭
    - 과거 성과
    - 접근성 지표
- Senior 모드: 동선 요약 단순화(“3곳 방문, 총 90분, 예상 200명 접촉”)

## 8. 제약·정책 (컴플라이언스/보안/운영)

### 8.1 법·선거 규정 준수

- **중앙선관위 지침 반영**
    - 예비후보자 시점: 시설 방문, 라포 형성 중심 (거점 인사 제한).
    - 후보자 등록 이후: 정식 유세 가능, 거점/출퇴근 유세 허용.
- **허용/금지 활동 자동 필터링**
    - 후보자 등록 이전: 유세복/어깨띠 착용 금지 → 스케줄러에서 제외.
    - 지정 품목(마이크, 현수막 등)만 제휴몰에 노출.
    - 차량·LED 스크린 등은 법적 허용 여부 및 급별 제한을 반영.
- **공보물 규정**
    - 구의원: 8p, 구청장 이상: 16p 이상.
    - 자간/줄간/여백 등 형식 지침 준수 → 공보물 자동 생성기에서 필터링.

### 8.2 증빙·심사 기준

- **증빙 제출 의무**
    - 모든 지출 항목: 영수증 + 사진 + GPS/시간 메타데이터 필수.
    - 모든 유세 활동: 활동 사진(셀피+현장) 또는 메모 증빙.
- **검증 절차**
    - 파일 해시 생성 → 위변조 방지.
    - 업로드 시 자동 메타 태깅 (GPS 좌표, 촬영 시각).
    - 관리자 검토 단계:
        - 승인 / 반려 / 보완 요청.
        - 반려 시 사유 기록.
- **심사 기준**
    - 선관위 지정 품목 여부.
    - 활동 맥락 적절성 (시간/위치/상황 불일치 시 반려).
    - 개인정보 노출 최소화.

### 8.3 화이트리스트 제품군

- **유세차량**
    - 픽업트럭(랩핑), 자전거/전동킥보드, 리어카TV(비확성).
- **유세물품**
    - 어깨띠, 조끼, 현수막, 피켓, 인쇄물.
- **홍보매체**
    - 공보물 인쇄(규격 준수), SNS 광고(법정 비용 한도 내).
- **금지 품목**
    - 현금/현물 직접 제공, 기부 성격의 물품.
    - 과도한 출력(LED/앰프) – 구의원급 제한.

### 8.4 보안·접근 정책

- **인증**
    - 휴대폰 본인인증 + JWT 토큰 기반 로그인.
- **역할 기반 접근제어 (RBAC)**
    - 후보자: 자기 데이터만 접근 가능.
    - 중앙 관리자: 전체 후보 데이터 열람/공지 푸시.
    - 뷰어: 읽기 전용 권한(옵션).
- **파일 관리**
    - S3 호환 스토리지 사용.
    - presigned URL 발급, 유효기간 만료 후 접근 불가.
    - 다운로드 로깅.

### 8.5 데이터 거버넌스

- **보관·파기**
    - 선거 종료 +30일 → 자동 파기.
    - 예외(법적 보존 필요)는 별도 동의 및 암호화 보관.
- **로그 기록**
    - 누가/언제/무엇을 열람·수정했는지 저장.
- **암호화**
    - 개인정보 필드 단위 암호화(AES-256).
    - 전송 구간 TLS 1.3 이상.

### 8.6 운영·품질 정책

- **장애 대응**
    - 스케줄러 불가 시 → 단순 체크리스트 모드로 폴백.
- **UI 접근성**
    - 나이·폰트 설정 기반 Default/Senior 모드 자동 추천.
- **푸시/공지**
    - 모든 공지/전술 푸시는 철회 및 변경 로그를 남김.
    - 감사 추적 가능.
- **랭킹/크레딧**
    - 월말 환급 규칙은 서버 정책으로만 관리.
    - 버전/시행일 기록 유지.

## 9. 프런트–백엔드 데이터 계약 (핵심 키)

프론트엔드(앱·웹)와 백엔드(FastAPI/Java 서비스)가 동일한 언어로 통신할 수 있도록 **키와 값의 스펙**을 통일한다.

→ UI 버튼·카드와 API 응답 JSON이 1:1 매핑되어야 함.

### 9.1 Task 관련

- **Task.type**
    - `"poi-visit"` : POI 거점 인사 유세
    - `"facility-visit"` : 시설/단체 방문
    - `"doc-check"` : 공천·출마 서류 검토
    - `"ad-purchase"` : 유세 물품/광고 구매
        
        → UI 카드의 아이콘/모달 종류 분기
        
- **Task.tertiary**
    - `"defer"` : 미루기 버튼
    - `"proof"` : 증빙 업로드 버튼
    - `"nav"` : 네비게이션 버튼
    - `"open"` : 모달/웹 열기 버튼
        
        → UI의 3번째 버튼 라벨·동작과 1:1 매핑
        
- **Task.status**
    - `"planned"` : 예정
    - `"started"` : 진행 중
    - `"done"` : 완료
    - `"failed"` : 실패/취소

### 9.2 Proof (증빙)

- **Proof.kind**
    - `"photo"` : 현장 사진
    - `"receipt"` : 지출 영수증
- **Proof.meta**
    - `gps`: 위도·경도
    - `taken_at`: 촬영 시각
    - `hash`: 파일 무결성 해시값
- **Proof.review**
    - `verified_by_admin`: boolean
    - `review_status`: 승인/반려/보완
    - `reason`: 반려 사유 텍스트

### 9.3 Broadcast / 공지

- **Broadcast.severity**
    - `"info"` : 단순 알림 (파란색 리본)
    - `"warn"` : 주의 권고 (노란색 리본)
    - `"critical"` : 긴급 지시 (빨간색 리본)
- **Broadcast.payload**
    - `title`: 공지 제목
    - `html`: 본문 (리치텍스트/링크 포함)

### 9.4 Profile (유저 설정)

- **Profile.intensity** (일정 강도)
    - `"hard"` : 하루 풀 스케줄 (08:00~22:00)
    - `"normal"` : 보통 밀도
    - `"light"` : 여유 모드 (선택적 일정만)
- **Profile.religion_pref** (종교 선호도)
    - `"none"` : 구분 없음
    - `"exclude:[X]"` : 특정 종교 기관 제외
    - `"only:[Y]"` : 특정 종교 기관만 포함
- **Profile.mobility** (이동수단)
    - `"car"`, `"pickup"`, `"trike"`, `"bike"`, `"walk"`
    - 스케줄러가 이동 속도/거리 산출 시 반영
- **Profile.font_scale**
    - `"default"` : 기본 UI
    - `"large"` : Senior 모드 (큰 글씨·단일 카드)

### 9.5 Credit / 재정

- **Credit.kind**
    - `"in"` : 후원/보조금 유입
    - `"out"` : 유세 비용 지출
    - `"hold"` : 증빙 대기
- **Credit.meta**
    - `amount`: 숫자
    - `ref`: 참조 Task/Proof
    - `memo`: 간단 메모

### 9.6 문서 / 서류

- **Document.kind**
    - `"nomination"` : 공천 서류
    - `"nec_form"` : 선관위 지정 양식
- **Document.status**
    - `"draft"` : 작성 중
    - `"submitted"` : 후보 제출 완료
    - `"reviewed"` : 관리자 검토 완료
    - `"transferred"` : 선관위 이관 완료

### ⚡ 요약

- 모든 핵심 키는 **UI ↔ API ↔ DB**를 동일하게 유지.
- 예: `Task.tertiary = "proof"` → 앱 카드에서 “증빙 업로드” 버튼 활성화 → `/tasks/:id/complete` 호출 시 Proof.kind=receipt/photo와 연결.

## 10. 향후 과제 (Next Steps & Memo)

본 문서는 v2.1 수준의 풀패키지 기획/명세를 다루었으며, **MVP → 확장** 단계로 나아가기 위해 다음 과제들을 고려한다.

### 10.1 프론트엔드 (앱/UI/UX)

- **IntersectionObserver 기반 무한 스크롤**
    - 후보자 앱의 할 일(TaskCard) 목록에 적용 → 초기에는 2개만 노출, 스크롤 시 점진적 로딩.
    - 목데이터 기반 구현 가능, 이후 백엔드 API pagination 연동.
- **A/B 테스트 플래그 시스템**
    - ETA 배지, 동선 요약 시트, 근거 시트 노출 방식 등을 플래그 기반으로 제어.
    - 중앙 관리자(Admin) 대시보드에서 플래그 On/Off 가능하도록 확장.
- **접근성 고도화**
    - Senior 모드 외에 컬러 블라인드 모드, 음성 안내 등 옵션 추가 검토.
- **리팩토링 & 컴포넌트화**
    - Button, TaskCard, FooterNav 등은 `/components/` 폴더로 분리, 재사용성 확보.

### 10.2 백엔드 (FastAPI/Java)

- **POI 데이터 소스 통합**
    - 공공 API (예: 행정안전부 생활인구, 교통공사 승하차 인원) + 내부 입력(족보 DB) + 크롤링 데이터.
    - 갱신 주기: 1일/1주 단위 → ETL 파이프라인 설계 필요.
- **스케줄러 최적화 알고리즘**
    - OR-Tools/GraphHopper/OSRM 중 선택.
    - 체류 시간·거리 비용 최소화 + 접촉 수 최대화 → Mixed Integer Programming 기반.
- **공보물 자동 생성**
    - 템플릿 버전 관리 (ex. v1.0 ~ vN), 폰트/색상/카피 규정 준수.
    - Adsland, 외부 벤더 API 매핑.
- **후원/정산 자동화**
    - Task/Proof/Donation ↔ Credit Ledger 자동 연동.
    - 월말/분기 단위 환급 내역 CSV 생성, 선관위 제출 형식까지 자동 변환.

### 10.3 데이터 & 거버넌스

- **POI/Cluster 갱신 파이프라인**
    - 신규 후보자/관리자 입력 → 자동 반영.
    - 관리자는 우선순위 점수(β값) 조정 가능.
- **공보물 템플릿 & 가이드라인 자동 검증**
    - 민감 단어 필터링 (비방, 금지어).
    - 이미지/사진 DPI/색상 대비 규정 체크.
- **데이터 보관/파기 정책**
    - 선거 종료 +30일 후 자동 파기.
    - 단, 선관위 감사/법적 요구 시 별도 보관(서면 동의).
- **로그/감사체계**
    - “누가, 언제, 무엇을 열람/수정했는지” 추적.
    - 법적 분쟁 대비 이력 유지.

### 10.4 운영/교육

- **출마자 교육 콘텐츠화**
    - 앱 튜토리얼: “오늘의 유세” 카드 → Proof 업로드 → 대시보드 확인.
    - 선거법 챗봇 + 실사례 → 교육 모드 제공.
- **톤앤매너 교육 가이드**
    - 명함 전달법, 피켓 규정, 유세 음악/볼륨 규칙 등 중앙당이 체크리스트화.
- **중앙 관리자 교육**
    - 대시보드에서 공지 작성, 랭킹 확인, 환급 집행 → 워크플로우 매뉴얼 제공.

### 10.5 기술 인프라

- **멀티테넌시 고려**
    - 향후 개혁신당 외 타 정당/조직에도 SaaS 확장 가능성.
- **Observability (관측성)**
    - GPS 업로드율, 스케줄러 지연, 랭킹 산출 시간, 문서 승인 TAT 등 주요 지표 모니터링.
- **Fail-safe**
    - 지도/스케줄러 장애 시 “체크리스트 모드”로 폴백.
- **CI/CD & 버전 관리**
    - GitHub Actions / Railway 배포 자동화.
    - 정책 변경(예: 환급 규칙) → 서버 버전 태깅 & ChangeLog 기록.

### ⚡ **핵심 메모**

- MVP 단계는 **앱 기본 루프(스케줄러/Proof/대시보드/챗봇) + 웹 최소한(서류/공지/랭킹)**에 집중.
- 이후 확장 과제들은 2025년 11월 공천 시점 전까지 **우선순위별로 단계적 적용** 필요.

## 11. 통합 로드맵 (Integrated Roadmap)

- 선거 일정(법정 데드라인)을 기준으로 **MVP → 확장 → 납품/운영** 단계별 통합 로드맵을 설계한다.
- 목표: **2025년 지방선거(6월) 대비, 2024년 11월 공천 확정 전까지 MVP 안정화**

### 11.1 단계별 로드맵

Phase 0. 사전 준비 (2025.08 ~ 2025.09)

- 기술 인프라
    - Monorepo 세팅 (/apps, /packages 구조)
    - React Native(Expo), Next.js, FastAPI, PostgreSQL 초기 세팅
    - CI/CD 파이프라인 (GitHub Actions, Railway/Render 배포)
- 데이터/정책
    - 선거법 자료 수집, 룰베이스 챗봇 초기 학습
    - POI 소스(공공 데이터, 내부 DB) 정리
    - 공보물 템플릿 v0.1 제작
- 산출물: Dev 환경 준비, 기본 DB 스키마, UI Mock (Default/Senior)

Phase 1. MVP 기능 구현 (2025.09 ~ 2025.10)

- 모바일 앱
    - 오늘의 유세(지도+카드뷰), Proof 업로드, 대시보드, 챗봇 연결
    - Default/Senior 모드 인터페이스
- 웹
    - 후보자 활동 대시보드
    - 문서 체크리스트/업로드
    - 중앙 관리자 공지 푸시
- 백엔드
    - 스케줄러(POI/클러스터 기반)
    - 크레딧 Ledger 표기 (공천금·후원금 연동)
    - Proof API (사진/영수증 + GPS/시간 메타)
- 산출물: **MVP v1.0 (앱+웹)** — 내부 파일럿

Phase 2. 공천 대응 (2025.11 ~ 2026.02)

- 후보자 등록 이전
    - 시설·단체 중심 유대 형성 루트 추천
    - 출마자 교육 콘텐츠(앱 튜토리얼, 챗봇 가이드)
    - 공보물 카피/디자인 자동화 1차 배포
- 후보자 등록 이후 (2월~)
    - 거점 인사 중심 루트 전환
    - 중앙당 집중 공지/전술 푸시 반영
    - 크레딧 환급 정책(Beta) 실행
- 산출물: **v1.5 (공천 특화 기능)**

Phase 3. 지방선거 준비 (2026.03 ~ 2026.05)

- 확장 기능
    - 랭킹/리워드 시스템 고도화
    - 무한 스크롤·A/B 테스트 플래그 적용
    - 공보물 발주 API 연동(Adsland 등)
    - 후원금 정산 CSV/선관위 양식 자동 변환
- 운영 강화
    - 관측성: GPS 업로드율, 랭킹 산출 지연 등 실시간 모니터링
    - Fail-safe 모드 (체크리스트 모드)
    - 멀티테넌시 PoC
- 산출물: **v2.0 (선거 캠프 운영 버전)**

Phase 4. 선거 본선 운영 (2026.06)

- 중앙당 관리자
    - Top-down 공지/전술 푸시 실시간 반영
    - 후보자 활동 랭킹 집계 및 격려/환급 실행
- 출마자
    - 앱 기반 유세 실행 → Proof 업로드 → 대시보드 확인 루프
    - 챗봇 선거법 Q&A + Web 상세 자료 확인
- 산출물: **v2.5 (운영판)** — 선거기간 집중 운영

Phase 5. 사후/회고 (2026.07 ~)

- 데이터 파기 (선거 종료 +30일)
- 보고서 산출 (성과 분석, 후보자 피드백)
- SaaS 확장 검토 (타 정당/조직용)
- 산출물: 사후 보고서, v3.0 SaaS 계획안

### 11.2 주요 마일스톤

| 날짜 | 마일스톤 | 산출물 |
| --- | --- | --- |
| 2025.09 | Dev 환경 세팅 완료 | Monorepo 구조, UI Mock |
| 2025.10 | MVP v1.0 내부 파일럿 | 앱/웹 베타 |
| 2025.11 | 공천 특화 기능 v1.5 | 시설 방문 중심 루트, 공보물 자동화 |
| 2026.02 | 후보자 등록 모드 전환 | 거점 인사 중심 루트 |
| 2026.04 | 확장 기능 v2.0 | 랭킹/리워드, 공보물 API, 후원 정산 |
| 2026.06 | 본선 운영 v2.5 | 실시간 공지, 증빙 관리, 운영판 |
| 2026.07 | 사후 회고 & 데이터 파기 | 성과 보고서, v3.0 SaaS 초안 |

### ⚡ **정리**

- 11월 공천 전: 필수 MVP 안정화 → 후보자 등록 이후 모드 전환 대응
- 2026년 6월: **본선 운영판(v2.5)** 완성 필수
- 이후: **SaaS 확장/다른 정당에도 제공 가능**한 수준까지

# reform-campaign-spec-v2.3

# 📑 개혁신당 캠페인 매니저 – 패키지 기획/명세 문서 (v2.3 · Full Draft)

---

이전버전(v2.2꼼꼼+추가사항): 

[reform_campaign_spec_v2.2](https://www.notion.so/reform_campaign_spec_v2-2-26676daa46b4806e972ad73181c05064?pvs=21)

[패키지 기획명세 추가 사항](https://www.notion.so/26776daa46b4803ea0e5cc0d6e93a884?pvs=21)

---

## 목차

1. 서비스 기획 (Product Vision & Scope)
2. 개발 기능 명세 (Feature & Tech Spec)
3. 인프라/배포/품질 (Infra / Deployment / Quality)
4. 정책 기획 (Operational Policies)
5. 사용자 시나리오 (User Scenarios)
6. 데이터 플로우 (Data Flow)
7. API 스펙 (API Specification)
8. 데이터 계약 (Data Contracts)
9. 스케줄러 / POI 산식 (Scheduler & POI)
10. 챗봇 구조 (Chatbot Architecture)
11. 화이트리스트 & 증빙 정책 (Whitelist & Proof Policy)
12. 교육/톤앤매너 정책 (Training & Tone of Manner)
13. 로드맵 & 운영 지표 (Roadmap & Metrics)
14. 향후 과제 (Future Work)

---

## 1. 서비스 기획 (Product Vision & Scope)

### 1.1 배경

- 정치 캠페인 현장은 즉시성·모바일 중심.
- 선거철 실무자는 PC 사용 시간 ↓, 현장 인사·유세 활동 ↑.
- 고객(개혁신당)의 요구: “모바일 앱 + 웹” 플랫폼 지정.

### 1.2 목표

- **모바일 앱 (가칭: 비서AI, React Native + Python BE)**
오늘의 퀘스트, 액션 기록, 챗봇 기반 가이드 → 현장 즉시성.
- **웹 (가칭: 개혁신당 캠페인, Next.js FE + Java/Python BE + Postgre DB)**
자료 관리, 대시보드 집계, 공천/공보물 서류 처리 → 행정/분석.

### 1.3 유저 타입

- **타입 1: 출마자(예비·후보자)**
원칙적으로 1계정/1캠프, 필요시 사무관에게 계정 공유 가능.
- **타입 2: 중앙당 관리자**
출마자 활동을 집계해 모니터링, 공지·전술 푸시 가능.

### 1.4 사용자 페르소나

- **2030 (예비)후보자**: 모바일 친숙, 빠른 입력, 즉시성.
- **4050 (예비)후보자**: 일정·자료 검토 중심, 증빙 확실.
- **60+ (예비)후보자**: 단순·큰 글씨 UI 필요 (Senior 모드).
- **중앙당 관리자**: 전체 뷰, 정책/전술 조정, 리포팅 관리.

---

## 2. 개발 기능 명세 (Feature & Tech Spec)
### 2.1 플랫폼별 기능

| 구분 | 모바일 앱(비서AI) | 웹(개혁신당 캠페인) |
| --- | --- | --- |
| 핵심 | 오늘의 유세(지도+카드), 자동 스케줄, 활동 기록, 챗봇 | 후보 관리, 공지 푸시, 대시보드, 서류 검토, 공보물 발주, 후원·정산 |
| 접근성 | Default/Senior UI (큰 글씨, 단일 카드) | 리스트/테이블, 필터/다운로드 |
| 증빙 | 사진/영수증 업로드, GPS/시간 메타 | 검토·승인·반려, 기록 저장 |
| 크레딧 | 표기용 회계: 후원/공천금 ↔︎ 사용내역 | 월말 정산, 환급 집행 |
| 챗봇 | 선거법/체크리스트 Q&A → 모달 → 웹 이동 | 정책문서 관리, FAQ 확장 |
| 권한 | 출마자 1계정(공유 가능) | 중앙 관리자(전체 가시성), Viewer(선택) |

### 2.2 데이터 모델 (요약)

#### 웹(개혁신당 캠페인) 주요 데이터 모델
- `users`, `profiles`, `roles` : 관리자, 후보자 정보 및 권한 관리
- `tasks`, `routes`, `proofs` : 후보자별 과업 관리, 증빙(사진/영수증) 연동
- `credit_ledgers`, `donations` : 후원금/지출 내역 관리, 정산/환급 모듈
- `documents`, `broadcasts` : 공천 서류 및 공지 푸시 관리
- `pois`, `signals` : POI, 유동인구 등 스케줄러 데이터(조회/분석)

> 웹에서는 후보자 관리, 증빙 심사, 정산, 공지 작성 및 집계 대시보드 중심으로 데이터가 활용됩니다.

- `pois`, `signals` : POI, 유동인구 등 스케줄러 데이터(조회/분석)

> 웹에서는 후보자 관리, 증빙 심사, 정산, 공지 작성 및 집계 대시보드 중심으로 데이터가 활용됩니다.

### 2.3 스케줄러 입력

- 시간대별 유동 인구 시그널
- POI 메타(진입/체류 용이성)
- 이벤트(졸업식, 장날)
- 후보 선호(종교/모빌리티/강도)
- 과거 성과(접촉 수)

---

## 3. 인프라/배포/품질 (Infra / Deployment / Quality)

### A. 백엔드/데이터

- **Supabase(권장)**: Postgres + Auth + Storage + Realtime
- **FastAPI(선택)**: 서버 전용 로직/웹훅/배치

### B. 앱 빌드·배포

- **Expo + EAS**: Dev(QR 실행), Build, OTA Update.
- Next.js 기반 웹 프론트엔드 구현
- Vercel Preview/Prod 배포 파이프라인 구성
- 환경변수: `NEXT_PUBLIC_*` 접두사 사용 (클라이언트 노출 허용)

- Vercel Preview/Prod 배포 파이프라인 구성
- 환경변수: `NEXT_PUBLIC_*` 접두사 사용 (클라이언트 노출 허용)

### D. 공통 계약

- **OpenAPI 스키마**로 정의.
- TS SDK 생성 → RN/Next 공용.
- 디자인 토큰/문구 패키지화.

### E. 관측/품질

- Sentry(에러 모니터링).
- Amplitude/Mixpanel.
- Feature Flag: GrowthBook/Unleash.

---

## 4. 정책 기획 (Operational Policies)

### 4.1 권한 체계
- 후보자(출마자): 본인 계정, 사무관과 공유 가능. 대시보드에서 개인 활동, 증빙, 서류 제출, 공지/팔로업 등 개별 인터페이스 제공
- 중앙 관리자(당 지도부): 전체 후보 현황 뷰, 정당 전체를 대상으로 한 공지·전술 메시지 발송, 공보물 콘텐츠 관리, 증빙 심사 및 정책 집행 등 권한 중심의 관리자 모드 제공

- 웹: 관리자(중앙당 지도부)와 후보자 각각에 맞는 대시보드 및 인터페이스 제공
    - 관리자: 전체 후보 현황 관리, 정당 단위 공지/전술/캠페인 메시지 발송(Top-down), 공보물 카피/콘텐츠 등록, 증빙 및 서류 심사, 크레딧 환급 등
    - 후보자: 개인 활동 및 증빙 현황 확인, 서류 제출, 공지/전술 메시지 및 팔로업 액션, 앱 챗봇에서 리다이렉트되어 정책 세부 정보 확인 가능
- 챗봇: 룰베이스 기반, AI 자동 생성 금지 (참고)

### 4.2 운영 정책

- 챗봇: 룰베이스 기반, AI 자동 생성 금지 (참고)
- 앱의 챗봇에서 정책/FAQ 클릭 시 웹 상세 정보 확인, 서류 제출 등 팔로업 액션이 자연스럽게 연결되도록 설계

- 챗봇: 룰베이스 기반, AI 자동 생성 금지 (참고)
- 앱의 챗봇에서 정책/FAQ 클릭 시 웹 상세 정보 확인, 서류 제출 등 팔로업 액션이 자연스럽게 연결되도록 설계

- 앱: 오늘의 유세 중심, 증빙 업로드, 챗봇 Q&A (API, 데이터 연동에 참고)
- 챗봇: 룰베이스 기반, AI 자동 생성 금지 (참고)

- 챗봇: 룰베이스 기반, AI 자동 생성 금지.

### 4.3 데이터 정책

- 로그/증빙 내부 검토 전용.
- 선거 종료 +30일 후 삭제.
- 외부 유출 금지.

---

## 5. 사용자 시나리오 (User Scenarios)

### 5.1 예비후보자 루프

- 앱 접속 → 리본 공지 확인.
- 미니맵 동선 확인(접촉 수/우선순위).
- 할 일 카드 실행:
    - POI 인사: GPS 트래킹 → 증빙 업로드.
    - 시설 방문: 일정 공지 모달 → 웹 리다이렉트.
- 후보자 리스트/상세/서류/증빙/후원 내역 통합 관리
- 공지·전술 푸시 발송 및 이력/철회 관리
- 월말 랭킹 산출 및 크레딧 환급 실행, 집계 대시보드
- 감사 로그(접근/수정/다운로드 기록) 및 CSV 내보내기
- 관리자별 권한 분리(전체/뷰어 등)


- 후보 등록 이후 거점 인사 비중 ↑.
- ETA 배지, 중앙 푸시 공지 반영.

### 5.3 관리자

- 후보자 리스트/상세/서류/증빙/후원 내역 통합 관리
- 공지·전술 푸시 발송 및 이력/철회 관리
- 월말 랭킹 산출 및 크레딧 환급 실행, 집계 대시보드
- 감사 로그(접근/수정/다운로드 기록) 및 CSV 내보내기
- 관리자별 권한 분리(전체/뷰어 등)

---

## 6. 데이터 플로우 (Data Flow)

앱(RN/Expo) → API(FastAPI/Supabase) → DB(PostgreSQL) → 웹(Next.js/Vercel).

- 인증: SMS → JWT.
- 증빙: 파일 업로드 + GPS/시간 메타.
- 챗봇: 룰베이스 → 웹 리다이렉트.

---

## 7. API 스펙 (API Specification)

- `POST /auth/login-sms` {phone} → {token}
- `GET /schedule/today` → {route, tasks[]}
- `POST /tasks/:id/start`
- `POST /tasks/:id/complete` {proofId?}
- `POST /proofs` (multipart) → {url, gps, time}
- `POST /chat/ask` {text} → {answer, refs, goto}
- `GET /credit/summary` → {balance, pendingCount}
- `GET /broadcasts/today` → {items[]}
- `GET /docs/checklist` → {items[]}

---

## 8. 데이터 계약 (Data Contracts)

- **Task.tertiary** ∈ {`defer`,`proof`,`nav`,`open`}
- **Task.type** ∈ {`poi-visit`,`facility-visit`,`doc-check`,`ad-purchase`}
- **Proof.kind** ∈ {`photo`,`receipt`}
- **Broadcast.severity** ∈ {`info`,`warn`,`critical`}
- **Profile.intensity** ∈ {`hard`,`normal`,`light`}
- **Mobility** ∈ {`car`,`pickup`,`trike`,`bike`,`walk`}

---

## 9. 스케줄러 / POI 산식

- **시간대 가중치**: 출퇴근 ×1.4, 주말 ×1.2, 야간 ×1.1.
- **노출 기준값**: 철도 300, 버스환승 200, 시장 150.
- **우선순위 규칙**: 출퇴근 상향, 등하교 하향.
- **공식**: exposure = base × time_weight + priority.
- **최적화 목표**: Σ(exposure) 최대화 – (이동/대기 비용).

---

## 10. 챗봇 구조

- **룰베이스**: 선거법 Q&A, 체크리스트.
- **소스**: 중앙선관위 FAQ, 과거 사례, 내부 DB.
- **모달 UX**: 근거 스니펫 → [자세히 보기] 웹 리다이렉트.
- **모드별**:
    - 예비후보자: 서류/규제 안내 비중 ↑.
    - 후보자: 현장 규칙/증빙 안내 ↑.

---

## 11. 화이트리스트 & 증빙 정책

- **화이트리스트 제품군**: 현수막, 명함, 어깨띠, 마이크, 차량 랩핑 등.
- **증빙 요건**: 사진/영수증 + GPS/시간 메타 필수.
- **심사 기준**: 중앙 관리자 승인/반려 기록.

---

## 12. 교육/톤앤매너 정책

- **출마자 교육**: 오프라인 필수(명함 배부, 톤/제스처).
### 13.2 운영 지표 (웹 중심)

- 증빙 심사 처리율 및 승인 TAT(Turn Around Time)
- 공지/전술 푸시 수신 및 열람률
- 크레딧 집계/정산 정확도, 환급 집행 내역
- 후보자별 서류 제출/승인 현황
- 접속/다운로드/접근 로그(감사)

### 13.1 로드맵

- **기능 정의**: 9월 1주 – 명세 확정.
- **1차 개발**: 9월 2~3주 – 앱 기본 화면, 웹 서류 업로드.
- **테스트**: 9월 4주 – 내부 피드백 반영.
### 13.2 운영 지표 (웹 중심)

- 증빙 심사 처리율 및 승인 TAT(Turn Around Time)
- 공지/전술 푸시 수신 및 열람률
- 크레딧 집계/정산 정확도, 환급 집행 내역
- 후보자별 서류 제출/승인 현황
- 접속/다운로드/접근 로그(감사)

- 크레딧 집계 정확도.

---

## 14. 향후 과제

- IntersectionObserver 기반 무한 스크롤.
- A/B 테스트 플래그 (ETA 배지 노출 방식).
- POI 데이터 소스 통합 (공공 API + 수기 족보).
- 공보물 템플릿 버전관리, 벤더 연동.
- 선거법 챗봇 사례 업데이트 파이프라인.

---